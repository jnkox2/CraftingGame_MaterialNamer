<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Material Designer Pro - Light Edition</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #ffffff; color: #212529; padding: 20px; font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; }
        .card { background-color: #fcfcfc; border: 1px solid #dee2e6; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .form-label { color: #495057; font-size: 0.85rem; font-weight: 600; margin-bottom: 4px; }
        .form-control, .form-select { border: 1px solid #ced4da; }
        .stat-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 12px; }
        .element-row { background: #f8f9fa; padding: 10px; border-radius: 6px; margin-bottom: 8px; border: 1px solid #e9ecef; border-left: 4px solid #0d6efd; }
        .record-item { background: #ffffff; border: 1px solid #dee2e6; transition: all 0.2s ease; cursor: pointer; margin-bottom: 10px; }
        .record-item:hover { border-color: #0d6efd; background-color: #f0f7ff; }
        .section-title { color: #0d6efd; border-bottom: 2px solid #e9ecef; padding-bottom: 8px; margin-bottom: 15px; font-weight: bold; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 0.5px; }
        
        /* Rarity Colors based on common RPG standards */
        .rarity-Legendary { color: #d97706; font-weight: bold; }
        .rarity-Epic { color: #9333ea; font-weight: bold; }
        .rarity-Rare { color: #2563eb; font-weight: bold; }
        .rarity-Uncommon { color: #16a34a; font-weight: bold; }
    </style>
</head>
<body>

<div class="container-fluid">
    <header class="pb-3 mb-4 border-bottom d-flex justify-content-between align-items-center">
        <span class="fs-4 text-dark fw-bold">ðŸ›  Material Designer <small class="text-muted fw-light">v2.1</small></span>
        <div>
            <button onclick="exportData()" class="btn btn-sm btn-dark">Download JSON</button>
        </div>
    </header>

    <div class="row">
        <div class="col-xl-8">
            <div class="card">
                <div class="card-body p-4">
                    <form id="materialForm">
                        <div class="row g-3 mb-4">
                            <div class="col-md-4">
                                <label class="form-label">Item Name</label>
                                <input type="text" id="itemName" class="form-control" placeholder="E.g. Star-Iron Ingot" required>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Rarity</label>
                                <select id="rarity" class="form-select"></select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Region (Location)</label>
                                <select id="location" class="form-select"></select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Texture</label>
                                <select id="texture" class="form-select"></select>
                            </div>
                        </div>

                        <div class="row g-3 mb-4">
                            <div class="col-md-2">
                                <label class="form-label">Color</label>
                                <select id="color" class="form-select"></select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Source</label>
                                <select id="source" class="form-select"></select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Lvl Req</label>
                                <input type="number" id="levelRequirement" class="form-control" value="0">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Cost</label>
                                <input type="number" id="cost" class="form-control" value="0">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Weight</label>
                                <input type="number" id="weight" class="form-control" value="0">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="section-title">Base Statistics</div>
                                <div class="stat-grid">
                                    <div><label class="form-label">HP</label><input type="number" id="hp" class="form-control" value="0"></div>
                                    <div><label class="form-label">Durability</label><input type="number" id="durability" class="form-control" value="0"></div>
                                    <div><label class="form-label">AD</label><input type="number" id="ad" class="form-control" value="0"></div>
                                    <div><label class="form-label">AP</label><input type="number" id="ap" class="form-control" value="0"></div>
                                    <div><label class="form-label">Atk Spd</label><input type="number" step="0.1" id="atkSpeed" class="form-control" value="0"></div>
                                    <div><label class="form-label">Crit %</label><input type="number" step="0.1" id="critChance" class="form-control" value="0"></div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="section-title">Elements (List&lt;Element&gt;)</div>
                                <div id="elementContainer"></div>
                                <button type="button" onclick="addElementRow()" class="btn btn-sm btn-outline-primary w-100">+ Add Element Pair</button>
                            </div>
                        </div>

                        <div class="mt-4">
                            <label class="form-label">Material Description</label>
                            <textarea id="description" class="form-control" rows="3"></textarea>
                        </div>

                        <div class="mt-4 pt-3 border-top">
                            <button type="button" onclick="saveMaterial()" class="btn btn-primary px-5">Save Record</button>
                            <button type="reset" class="btn btn-link text-muted" onclick="document.getElementById('elementContainer').innerHTML=''">Clear Form</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-xl-4">
            <h5 class="fw-bold mb-3">Saved Materials</h5>
            <div id="materialLibrary" class="list-group"></div>
        </div>
    </div>
</div>

<script>
    const Enums = {
        ItemRarity: ["Common", "Uncommon", "Rare", "Epic", "Legendary"],
        ItemTexture: ["Wood", "Stone", "Metal", "Gem", "Fuel", "Thread", "Cloth", "Special"],
        ItemElement: ["None", "Normal", "Fire", "Water", "Earth", "Air", "Electric", "Ice", "Poison", "Holy", "Dark", "Chaos", "Void"],
        ItemSource: ["Crafting", "Loot", "Treasure", "Quest", "Trade"],
        ItemColor: ["Red", "Blue", "Green", "Yellow", "Purple", "Orange", "Brown", "Black", "White", "Grey", "None"],
        ItemRegion: ["Rheonia", "Deimora", "Iorath", "Thalassia", "Arionis", "Kerbron"]
    };

    function populateDropdowns() {
        const mapping = {
            'rarity': Enums.ItemRarity,
            'texture': Enums.ItemTexture,
            'location': Enums.ItemRegion,
            'color': Enums.ItemColor,
            'source': Enums.ItemSource
        };

        for (let id in mapping) {
            const select = document.getElementById(id);
            mapping[id].forEach(val => {
                select.innerHTML += `<option value="${val}">${val}</option>`;
            });
        }
    }

    function addElementRow(elementVal = "None", valueVal = 0) {
        const container = document.getElementById('elementContainer');
        const rowId = Date.now();
        const div = document.createElement('div');
        div.className = 'element-row d-flex gap-2 align-items-center';
        div.id = `el-${rowId}`;
        
        let options = Enums.ItemElement.map(e => `<option value="${e}" ${e === elementVal ? 'selected' : ''}>${e}</option>`).join('');
        
        div.innerHTML = `
            <select class="form-select form-select-sm el-type">${options}</select>
            <input type="number" class="form-control form-control-sm el-val" style="width: 80px;" value="${valueVal}">
            <button type="button" class="btn btn-sm btn-outline-danger border-0" onclick="document.getElementById('el-${rowId}').remove()">âœ•</button>
        `;
        container.appendChild(div);
    }

    let library = JSON.parse(localStorage.getItem('materials_db_v2') || '[]');

    function saveMaterial() {
        const name = document.getElementById('itemName').value;
        if(!name) return alert("Please enter an Item Name");

        const elements = [];
        document.querySelectorAll('.element-row').forEach(row => {
            elements.push({
                element: row.querySelector('.el-type').value,
                value: parseInt(row.querySelector('.el-val').value)
            });
        });

        const material = {
            id: Date.now(),
            itemName: name,
            rarity: document.getElementById('rarity').value,
            texture: document.getElementById('texture').value,
            location: document.getElementById('location').value,
            color: document.getElementById('color').value,
            source: document.getElementById('source').value,
            levelRequirement: parseInt(document.getElementById('levelRequirement').value),
            cost: parseInt(document.getElementById('cost').value),
            weight: parseInt(document.getElementById('weight').value),
            element: elements,
            itemStats: {
                hp: parseFloat(document.getElementById('hp').value),
                durability: parseFloat(document.getElementById('durability').value),
                ad: parseFloat(document.getElementById('ad').value),
                ap: parseFloat(document.getElementById('ap').value),
                atkSpeed: parseFloat(document.getElementById('atkSpeed').value),
                critChance: parseFloat(document.getElementById('critChance').value)
            },
            description: document.getElementById('description').value
        };

        library.push(material);
        localStorage.setItem('materials_db_v2', JSON.stringify(library));
        renderLibrary();
        document.getElementById('materialForm').reset();
        document.getElementById('elementContainer').innerHTML = '';
    }

    function renderLibrary() {
        const list = document.getElementById('materialLibrary');
        list.innerHTML = '';
        library.forEach((item) => {
            const badges = item.element.filter(e => e.element !== 'None').map(e => 
                `<span class="badge bg-light text-primary border me-1">${e.element} +${e.value}</span>`
            ).join('');

            const li = document.createElement('div');
            li.className = 'list-group-item record-item p-3 rounded shadow-sm';
            li.innerHTML = `
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        <div class="rarity-${item.rarity} small text-uppercase fw-bold" style="font-size: 0.7rem">${item.rarity}</div>
                        <h6 class="mb-1 fw-bold text-dark">${item.itemName}</h6>
                        <div class="text-muted" style="font-size: 0.8rem">
                            ${item.location} | Cost: ${item.cost} | Wgt: ${item.weight}
                        </div>
                    </div>
                    <button class="btn btn-sm btn-outline-danger" onclick="deleteItem(${item.id})">Ã—</button>
                </div>
                <div class="mt-2">${badges}</div>
            `;
            list.appendChild(li);
        });
    }

    function deleteItem(id) {
        if(confirm("Delete this material?")) {
            library = library.filter(i => i.id !== id);
            localStorage.setItem('materials_db_v2', JSON.stringify(library));
            renderLibrary();
        }
    }

    function exportData() {
        const blob = new Blob([JSON.stringify(library, null, 2)], {type : 'application/json'});
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'Items_Export.json';
        a.click();
    }

    window.onload = () => {
        populateDropdowns();
        renderLibrary();
    };
</script>

</body>
</html>
